# 简介

本手册将对以下的问题进行讨论：

1. 编写、编译、烧写以及调试 Rust 嵌入式程序；
2. 访问通用外设：GPIO、ADC、PWM、I2C、SPI等；
3. 实时系统的进程调度；



在阅读本手册时，推荐你准备下面的东西：

1. STM32F4 系列开发板
2. 对应芯片的数据手册

## Cortex-M4 微处理器基础

Cortex-M4 基于3级流水线哈佛架构，部分处理器集成了 FPU 浮点处理单元，SIMD乘法以及乘累加能力，饱和运算和专用硬件部门。

我们需要重点理解和掌握的是 Cortex-M4 处理器的中断处理。ARM Cortex-M4 的中断向量表中包含下面的内容。

1. 初始堆栈指针
2. 15个内核中断处理函数指针
3. 97个外部中断处理函数指针



###  启动过程分析

处理器上电后，根据 boot\[1:0\] 引脚的电平，选择下面 3 中启动模式的一种，并且将相应区域的内存映射到 SRAM 中。

| BOOT1 | BOOT0 | 启动区域 | 启动模式 |
| :--- | :--- | :--- | :--- |
| X | 1 |  |  |
| 0 | 1 |  |  |
| 1 | 0 |  |  |



TODO:

1. 启动过程分析
2. 中断向量长度与具体意义
3. Linker script 的编写

## 环境配置

#### 安装 Rust

```
curl https://sh.rustup.rs -sSf | sh
```

#### 安装 ARM-GCC

```
brew cask install gcc-arm-embedded openocd
```



## 第一个程序

在编写第一个程序之前，需要对下面的内容进行讲解。

1. 程序从源代码编译为可运行代码经过的过程，编译——链接
2. Rust 如何指定链接器
3. 链接器脚本的编写；



在 Rust 中，可以通过 cargo 配置来指定链接时使用的链接器，当前我们仍然需要使用 gcc-ld 来进行链接工作。



链接器所进行的工作是将



